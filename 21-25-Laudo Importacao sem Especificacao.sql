-- Laudo Faltantes Lotes

--Mapear Lotes
--NF Saida Cab.
Select F2_FILIAL,F2_EMISSAO, * From SF2010
Where F2_FILIAL = 'BA03' and F2_DOC In ('000060562') and D_E_L_E_T_='' and F2_EMISSAO >= '20230101'
--NF Saida Itens
Select D2_NFORI,D2_ZZFILFB,D2_LOTECTL,D2_DOC,D2_OP, * From SD2010
Where D2_FILIAL ='BA03' and D2_DOC = '000060562'  and D_E_L_E_T_='' and D2_EMISSAO >= '20230101'

--Mapear NF de Entrada - Filal Destino  
--NF Entrada Cab.
Select D_E_L_E_T_,F1_EMISSAO, F1_DTLANC,F1_ESPECIE, * From SF1010
Where F1_FILIAL = 'DB01' and F1_DOC In ('000060562') and D_E_L_E_T_=''and F1_EMISSAO >= '20230101'
--NF Entrada Itens
Select D1_DOC,D1_OP,D1_LOTECTL,D1_FORNECE,D1_LOJA, * From SD1010
Where D1_FILIAL ='DB01' and D1_DOC In ('000060562') or D1_LOTECTL In ('3230343','3230344','3230374','3230375')
and D_E_L_E_T_ ='' and D1_EMISSAO >= '20230101'



-- SD2 - NF Saida Itens - Filial Origem 
SELECT D2_ZZFILFB,D2_DOC,D2_LOTECTL,D2_ZZFILFB,* FROM SD2010 WHERE D2_FILIAL='BA03' 
AND D2_LOTECTL IN ('3230343','3230344','3230374','3230375') and D_E_L_E_T_ =''
--UPDATE SD2010 SET D2_ZZFILFB='BA03' WHERE D2_FILIAL='BA01' AND D2_LOTECTL IN ('3221757','3221773','3221780','3221809')

-- SD2 - NF Saida Itens - Filial Destino Industrializacao
SELECT D2_ZZFILFB,D2_DOC,D2_LOTECTL,* FROM SD2010 WHERE D2_FILIAL='BA03' 
AND D2_DOC In ('000060562') or D2_LOTECTL In ('3230343','3230344','3230374','3230375')



-- SD2 - NF Saida Itens - Filial Origem - Mapear NFs
SELECT D2_ZZFILFB,D2_DOC,D2_LOTECTL,* FROM SD2010 WHERE D2_FILIAL='BA03' 
AND D2_DOC In ('000060562') and D_E_L_E_T_ =''


-- Cadastro de Produto - Localizar Codigo do Destino 0900
SELECT B1_ZZCDREF, B1_ZZFLREF, * FROM SB1010 WHERE B1_COD='0900240025'
--UPDATE SB1010 SET B1_ZZCDREF='0100179201', B1_ZZFLREF='BA03' WHERE B1_COD='0902110101'  

-- De acordo com o D2_ZZFILFB preenchido, gera a Z3. (Se não gerado, fazer manualmente)
SELECT * FROM SZ3010 WHERE Z3_FILIAL In ('BA03','BA03') AND 
Z3_LOTECTL IN ('3230343','3230344','3230374','3230375')


--Amarração do produto que foi produzido com o que irá ser utilizado

-- 
SELECT BZ_ZZCDREF, * FROM SBZ010 WHERE BZ_COD='0100049825'
--UPDATE SBZ010 SET BZ_ZZCDREF='', BZ_FILIAL='BA01' WHERE BZ_COD='0100179201'     --0110010281

SELECT BZ_ZZCDREF, * FROM SBZ010 WHERE BZ_ZZCDREF='0100049825'


--Identificar a OP e Lote utilizado:
--SD3 - Movimentacoes Internas
SELECT * FROM SD3010 WHERE D3_FILIAL='BA03' AND D3_LOTECTL In ('3230343','3230344','3230374','3230375')
and D3_COD = '0900240025'And D3_ESTORNO = '' and D_E_L_E_T_ =''

--SD4 - Requisicoes Empenhadas
SELECT D4_COD,D4_PRODUTO,* FROM SD4010 
WHERE D4_FILIAL='BA03' AND D4_OP In ('03517901001','03518001001','03527401001','03527501001','03527601001') AND D_E_L_E_T_=''


-- Achar o Produto 0400710011    
--QPK - Insp.Processos - Avaliacoes
Select * From QPK010
Where QPK_FILIAL In ('BA03','AE01') and QPK_PRODUT = '0400710021' and 
QPK_LOTE In ('AUTO066954','AUTO066955','AUTO067151','AUTO067152','AUTO067153') and D_E_L_E_T_ = ''

-- QPM - Laudo da Operacao
Select * From QPM010
Where QPM_FILIAL In ('AE01','BA03') and QPM_PRODUT = '0400710021' and 
QPM_LOTE In ('AUTO066954','AUTO066955','AUTO067151','AUTO067152','AUTO067153') and D_E_L_E_T_ = ''




--Exemplo BZ3
SELECT * FROM SZ3010 WHERE Z3_FILIAL='BA03' AND Z3_LOTECTL IN ('7222013','7222060','7222066')